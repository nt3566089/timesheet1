## ActiveFault(CH12407)

現在発生中のフォルト 及び 過去に発生したフォルトの履歴を確認することが出来る。

本件はPGS2039SGPであり、対象テリトリはMNのみである。

### Overview

**<概要>**

機械確認画面において、現在発生中のフォルト 及び 過去に発生したフォルト履歴を確認することが出来る。
補足
フォルト発生が通知されると、通常のフォルト表示を行います。この状態で、フォルト画面を\[閉じる\]ボタン等で閉じて、機械確認>エラー情報>原因/詳細 を表示させる事で、発生中のフォルトをリストで確認することが出来ます。
※PGS1253SGPのPPFL(ProductionPrinterFaultList)に見られるような、フォルト発生が通知されても、フォルト画面を表示しない様な事はありません。

確認出来る内容は以下の通り。

1.  発生中のフォルトをリストの形で表示する。表示する対象のフォルトは次項参照。「CurrentMessage」や「フォルト原因」や「原因」とも表現する。

2.  発生中のフォルトをリストの形で表示し、さらにリスト選択操作により詳細画面を表示する。詳細画面にはフォルトを解除するための方法が書かれる。表示する対象のフォルトは次項参照。「CurrentFault」や「フォルト詳細」や「詳細」とも表現し、詳細画面は「Instruction画面」とも表現する。

3.  フォルト履歴を表示する。本件はDIAGのFaultHistory機能と同等の動作となる。詳細はDaig参照のこと。

**<関連するDFD>**

-   MCStatusタブ表示に関しては、09 MC Status の項参照のこと。

-   Diagに関しては、17 Diag の項参照のこと。

### 動作
初めに: 各画面で、表示対象とするフォルトは以下の通り。

|FF Fault分類|(a) フォルト原因一覧画面|フォルト詳細画面|(d) フォルト履歴一覧画面||
|---|---|---|---|---|---|
|||(b)一覧画面|(c) 詳細画面||
|SystemFail||||○|
|SubSystemFail|○|||○|
|ServiceFail|○|||○|
|LocalFail|○|||○|
|JobFail||||○|
|Jam(Dynamic)|下のJamZoneを使用|下のJamZoneを使用|○||
|Jam(static)|||||
|JamZone|○|○|○||
|Interlock|○|○|○||
|DevcieError(消耗品)|○|○|○||
|Operation/NoticeError|||||
|隠しFail|||||
|Warning|||||
|TimeBomb(Info)|○||||


1.  フォルト原因とフォルト詳細の違いは、詳細画面を持っているフォルトかどうかの違い。フォルト原因の中で、詳細画面(Instruction画面)を持っているものは「フォルト詳細」の表示対象となる。
→ であれば1つの画面で、詳細表示出来るものはリストボタンが押せるようにすれば良かったのでは?
→→ PGS2039SGPの為、別々の画面で、分けて表示しています。

1.  ジョブ中に発生するOpeErrorやNoticeは対象外とする。ジョブと切り離して、あくまでも「デバイス状態のフォルト」を表示対象とする。

2.  DevcieErrorは、「DeviceError消耗品」を対象とする。
→ 本機能導入時点で、DeviceErrorは(1)InterlockDeviceErrorと(2)消耗品DeviceErrorの2タイプしか存在しない。
Interlockは別途項目として存在するので、残りのDeviceErrorとは、「消耗品のDeviceError」ということになる。
今後、消耗品以外のDeviceErrorが増えた場合は、その時点で見直し必要

1.  TimeBomb(Info)とは、具体的には、本体の消耗品のみを対象とする
→ Finisherなどのオプションの消耗品は含まない。よってホチキスやパンチのInfoは非表示。本機能導入時の決定事項。
実装情報
リスト表示に関して･･･
原因一覧も詳細一覧も、表示しているリストの元になっているデータは、JRMから提供される専用のIFで取得したものです。表示順も保障されています。
詳細一覧も原因一覧も、JRMIF上は同一のリクエスト/レスポンスで実現します。要するに、JRMからは常に 「原因一覧向け」 のリストがレスポンスとして返される。
よって、
- 原因一覧表示の場合は、そのレスポンスをリストとしてそのまま採用するが、
- 詳細一覧表示の場合は、必要なものだけ(Jam・Itlk・DevErr消耗品だけ)をUIでフィルタして表示する

#### フォルト原因(Current Message)

1.  フォルト原因一覧画面を表示する際、対象フォルトが発生していれば、リストに表示する。

2.  一覧画面で表示する内容は、エラー箇所が特定できる内容とする(正確にはダイアログ仕様書参照)

3.  表示順はコントローラ側の仕様に従う。

4.  
参考情報


→制限を設けていないので通知された数だけ表示する。20090709

1.  画面表示中に、対象のフォルトが解除された場合、一覧画面をリハッシュする
実装情報
対象にする通知Eventは、IitStateEvent、IotStateEventとする。
IITJam数に変化があった場合リハッシュしてみる。結果、見た目は何も変わらず、前回と同じ項目が表示される事もある。同様にIotJam
/ IitInterlock / IotInterlock / DeviceError。
Infoの状態変化は、起きる頻度が少ないのでリハッシュ対象にしない。

1.  Keyの受付は特に制限なし

2.  一覧表示中でも通常のフォルト処理は動作させるので、一覧画面の上にインターロック画面が表示される事もある。(=インターロック画面を閉じるボタンで閉じると今発生したインターロックが一覧に表示されていることになる)
    > 。また、パスウェー切り替えや、上にかぶっていた画面消去によりフォアグラウンド化された時など、一覧を再表示するタイミングでリハッシュを行う。

3.  フォルト原因一覧画面で表示する項目とその表示条件については以下のとおり。具体的な値についてはAPPENDIX参照のこと。

|表示する項目|Apndx<br/>No<br/>|表示条件||||
|---|---|---|---|---|---|---|
|||Code|カテゴリ|サブパラメータ|備考|
|FF-Fault分類 : SubSystem Fail/ServiceFail/Local Fail||||||
|故障(自動原稿送り装置)|1.1.1|ChainLink ( FltType=SubSystem / Service / Local)|CVT|参照しない||
|故障(自動両面原稿送り装置)|1.1.2||CVT Daimajin|↑||
|故障(IISS)|1.1.3||IISS|↑||
|故障(IISS Extension)|1.1.4||IISS-Extention|↑||
|故障(プリンター本体)|1.2.1||IOT|↑||
|故障(用紙トレイ1)|1.2.2||IOT Tray1|↑||
|故障(用紙トレイ2)|1.2.3||IOT Tray2|↑||
|故障(用紙トレイ3)|1.2.4||IOT Tray3|↑||
|故障(用紙トレイ4)|1.2.5||IOT Tray4|↑||
|故障(用紙トレイ5(手差し))|1.2.6||IOT Tray5|↑||
|故障(大容量トレイ)|1.2.7||IOT HCF|↑||
|故障(用紙トレイ6(大容量))|1.2.8||IOT HCF Tray1|↑||
|故障(用紙トレイ7(大容量))|1.2.9||IOT HCF Tray2|↑||
|故障(用紙トレイ3(大容量))|1.2.10||IOT TTM1|↑||
|故障(用紙トレイ4(大容量))|1.2.11||IOT TTM2|↑||
|故障(両面プリントユニット)|1.2.12||IOT Duplex|↑||
|故障(オフセット排出ユニット)|1.2.13||IOT OCT|↑||
|故障(大容量トレイ1)|1.2.14||IOT HCF||重連時※1|
|故障(大容量トレイ2)|1.2.15||IOT HCF2||重連時|
|故障(用紙トレイ8(大容量))|1.2.16||IOT HCF2 Tray1|||
|故障(用紙トレイ9(大容量))|1.2.17||IOT HCF2 Tray2|||
|故障(フィニッシャー)|1.3.1||Finisher(Output)|↑||
|故障(フィニッシャートレイ排出口)|1.3.2||Finisher Compiler|↑||
|故障(ホチキス装置)|1.3.3||Finisher Knife|↑||
|故障(パンチ装置)|1.3.4||Finisher Puncher|↑||
|故障(排出トレイ)|1.3.5||Finisher Stacker1|↑||
|故障(フィニッシャートレイ)|1.3.6||Finisher Stacker2|↑||
|故障(ホチキス装置)|1.3.7||Finisher Stapler|↑||
|故障(中とじユニット)|1.3.8||Finisher Booklet|↑||
|故障(中とじ用フィニッシャートレイ排出口)|1.3.9||Finisher Booklet Compiler|↑||
|故障(中とじ用ホチキス装置)|1.3.10||Finisher Booklet Knife|↑||
|故障(中とじ用パンチ装置)|1.3.11||Finisher Booklet Puncher|↑||
|故障(中とじ用製本トレイ)|1.3.12||Finisher Booklet Stacker|↑||
|故障(中とじ用ホチキス装置)|1.3.13||Finisher Booklet Stapler|↑||
|故障(インターフェースモジュール)|1.3.14||IFM|↑||
|故障(スタッカートレイ)|1.3.15||HCS1|↑||
|故障(スタッカートレイ1)|1.3.16||HCS1|↑|重連時※1|
|故障(スタッカートレイ2)|1.3.17||HCS2|↑|重連時|
|故障(パンチモジュール)|1.3.18||CoilPuncher|↑||
|故障(パンチモジュール)|1.3.18||同上<br/>(UIでSpartaか判断)<br/>|↑|Spartaの場合、英表記は「Sparta」|
|故障(トリマーユニット)|1.3.19||Trimmer|↑||
|故障(外部フィニッシャーインターフェースモジュール)|1.3.20||PFIM|↑||
|故障(くるみ製本機)|1.3.21||PB|↑||
|故障(コントローラ)|1.4.1||Controller|↑||
|故障(ソフトウエアオプション)|1.4.2||Controller Soft Option|↑||
|故障(USB)|1.4.3||Controller USB|↑||
|故障(メモリーカードリーダー)|1.4.4||Controller Media Reader|↑||
|故障(イメージ高圧縮キット)|1.4.5||S2X(高圧縮PDFボード)|↑||
|故障(ファクスメインボード)|1.4.6||Fax Card Mother|↑||
|故障(ファクス拡張ボード1)|1.4.7||Fax Channel 01|↑||
|故障(ファクス拡張ボード2)|1.4.8||Fax Channel 02|↑||
|FF-Fault分類 : Jam||||||
|原稿づまり|2.1|Code=IitJam|参照しない|参照しない||
|紙づまり(プリンター本体)|2.2|Code=IotJam|参照しない|本体系Zone||
|紙づまり(フィニッシャー)|2.3|||フィニッシャー系Zone||
|紙づまり(インターフェースモジュール)|2.4|||系Zone||
|紙づまり(スタッカートレイ)|2.5|||HCS1系Zone||
|紙づまり(スタッカートレイ1)|2.6|||HCS1系Zone|重連時|
|紙づまり(スタッカートレイ2)|2.7|||HCS2系Zone|重連時|
|紙づまり(パンチモジュール)|2.8|||コイルパンチユニット系Zone||
|紙づまり(パンチモジュール)|2.8|||同上<br/>(UIでSpartaか判断)<br/>|Spartaの場合、英表記は「Sparta」|
|紙づまり(トリマーユニット)|2.9|||トリマーユニット系Zone||
|紙づまり(外部フィニッシャーインターフェースモジュール)|2.10|||外部フィニッシャーインターフェースモジュール系Zone||
|紙づまり(くるみ製本機)|2.11|||くるみ製本機系Zone||
|FF-Fault分類 : Interlock||||||
|カバー確認(自動原稿送り装置)|3.1|Code=IitInterlock|参照しない|参照しない||
|カバー確認(プリンター本体)|3.2|Code=IotInterlock|参照しない|本体系Zone||
|カバー確認(フィニッシャー)|3.3|||フィニッシャー系Zone||
|カバー確認(インターフェースモジュール)|3.4|||系Zone||
|カバー確認(スタッカートレイ)|3.5|||HCS1系Zone||
|カバー確認(スタッカートレイ1)|3.6|||HCS1系Zone|重連時|
|カバー確認(スタッカートレイ2)|3.7|||HCS2系Zone|重連時|
|カバー確認(パンチモジュール)|3.8|||コイルパンチユニット系Zone||
|カバー確認(パンチモジュール)|3.8|||同上<br/>(UIでSpartaか判断)<br/>|Spartaの場合、英表記は「Sparta」|
|カバー確認(トリマーユニット)|3.9|||トリマーユニット系Zone||
|トリマーダストボックス確認|3.10|||トリマーダストボックス系Zone||
|カバー確認(外部フィニッシャーインターフェースモジュール)|3.11|||外部フィニッシャーインターフェースモジュール系Zone||
|カバー確認(くるみ製本機)|3.12|||くるみ製本機系Zone||
|FF-Fault分類 : DeviceError(消耗品)||||||
|ドラムカートリッジ交換|4.1|ChainLink(FltType=device)|IotDrumChange IotDrumLifeEnd※3|参照しない※8|※2:NVMも参照|
|ドラムカートリッジ確認|4.2||IotDrumCheck|↑||
|トナー交換|4.3||IotTonerChange|↑||
|トナー回収ボトル交換|4.4||IotWasteBottleChange|↑||
|トナー回収ボトル確認|4.5||IotWasteBottleCheck|↑||
|||||↑||
|ホチキスカートリッジ確認|4.6||FinisherStaplerCheck|↑||
|パンチダストボックス確認|4.7||FinisherPuncherCheck|↑||
|フューザーユニット交換|4.8||IotFuserWebChange|↑||
|クリーニングカートリッジ交換|4.8.1||IotFuserWebChange|↑||
|クリーニングカートリッジ確認|4.8.2||IotFuserWebCheck|↑||
|消耗品確認|4.9||IotIbt2ndBtrCheck|↑||
|転写ベルト交換|4.9.1||IotIbtChange|↑||
|転写ベルト確認|4.9.2||IotIbtCheck|↑||
|第2バイアス転写ロール確認|4.9.3||Iot2ndBtrCheck|↑||
|トナー確認|4.10||IotTonerCheck|↑||
|コイルパンチユニット確認|4.11||-|↑|未使用|
|コイルパンチダストボックス確認|4.12||-|↑|未使用|
|FF-Fault分類 : Info||||||
|交換時期(イエロートナー(Y))|5.1.1|Code=ChangeParts-|参照しない|PartsID&amp;Status||
|交換時期(マゼンタトナー(M))|5.1.2|||↑||
|交換時期(シアントナー(C))|5.1.3|||↑||
|交換時期(ブラックトナー(K))|5.1.4|||↑||
|交換時期(ブラックトナー(K1))|5.1.5|||↑||
|交換時期(ブラックトナー(K2))|5.1.6|||↑||
|交換時期(トナーカートリッジ)|5.1.7|||↑||
|予備を用意(イエロートナー(Y))|5.2.1|||↑||
|予備を用意(マゼンタトナー(M))|5.2.2|||↑||
|予備を用意(シアントナー(C))|5.2.3|||↑||
|予備を用意(ブラックトナー(K))|5.2.4|||↑||
|予備を用意(ブラックトナー(K1))|5.2.5|||↑||
|予備を用意(ブラックトナー(K2))|5.2.6|||↑||
|予備を用意(トナーカートリッジ)|5.2.7|||↑||
||||||*4|
||||||*4|
||||||*4|
||||||*4|
|トナー交換(ブラックトナー(K1))|5.3.5|||↑|*4|
|トナー交換(ブラックトナー(K2))|5.3.6|||↑|*4|
|交換時期(ドラムカートリッジ(A4))|5.4.1|Code=ChangeParts-|参照しない|PartsID&amp;Status|*2:NVMも参照|
|交換時期(ドラムカートリッジ(A3))|5.4.2|||↑|*2:NVMも参照|
|交換時期(ドラムカートリッジ(A2))|5.4.3|||↑|*2:NVMも参照|
|交換時期(ドラムカートリッジ(A1))|5.4.4|||↑|*2:NVMも参照|
|交換時期(ドラムカートリッジ(R4))|5.4.5|||↑|*2:NVMも参照|
|交換時期(ドラムカートリッジ(R3))|5.4.6|||↑|*2:NVMも参照|
|交換時期(ドラムカートリッジ(R2))|5.4.7|||↑|*2:NVMも参照|
|交換時期(ドラムカートリッジ(R1))|5.4.8|||↑|*2:NVMも参照|
|交換時期(ドラムカートリッジ)|5.4.9|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(A4))|5.5.1|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(A3))|5.5.2|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(A2))|5.5.3|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(A1))|5.5.4|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(R4))|5.5.5|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(R3))|5.5.6|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(R2))|5.5.7|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ(R1))|5.5.8|||↑|*2:NVMも参照|
|予備を用意(ドラムカートリッジ)|5.5.9|||↑|*2:NVMも参照|
|予備を用意(トナー回収ボトル)|5.6.1|Code=ChangeParts-|参照しない|PartsID&amp;Status||
|予備を用意(トナー回収ボトル(B))|5.6.2|||↑||
|予備を用意(トナー回収ボトル(R1))|5.6.3|||↑||
|予備を用意(トナー回収ボトル(R5))|5.6.4|||↑||
|予備を用意(フューザーユニット)|5.7.1|Code=ChangeParts-|参照しない|PartsID&amp;Status|*5: IotRscも参照|
|予備を用意(フューザーユニット(E))|5.7.2|||↑|*5: IotRscも参照|
|予備を用意(フューザーユニット(R8))|5.7.3|||↑|*5: IotRscも参照|
|交換時期(フューザーユニット)|5.8.1|||↑|*5: IotRscも参照|
|交換時期(フューザーユニット(E))|5.8.2|||↑|*5: IotRscも参照|
|交換時期(フューザーユニット(R8))|5.8.3|||↑|*5: IotRscも参照|
|予備を用意(フューザーカートリッジ(R4))|5.9.1|||↑||
|予備を用意(クリーニングカートリッジ)|5.9.2|||↑||
|交換時期(フューザーカートリッジ(R4))|5.10.1|||↑||
|交換時期(クリーニングカートリッジ)|5.10.2|||↑||
|予備を用意(チャージコロトロン)|5.11.1|Code=ChangeParts-|参照しない|PartsID&amp;Status|*6: IotRscも参照|
|交換時期(チャージコロトロン)|5.11.2|||↑|*6: IotRscも参照|
|||||↑|本体のみ|
|交換時期(転写ベルトクリーナー (R6))|5.12.1|||↑||
|予備を用意(転写ベルトクリーナー (R6))|5.13.1|||↑||
|交換時期(第2バイアス転写ロール (R7))|5.14.1|||↑||
|予備を用意(第2バイアス転写ロール (R7))|5.15.1|||↑||
|交換時期(転写ベルト (R6))|5.16.1|||↑||
|交換時期(転写ベルトキット)|5.16.2|||↑||
|予備を用意(転写ベルト (R6))|5.17.1|||↑||
|予備を用意(転写ベルトキット)|5.17.2|||↑||
|||||XXX-XXX*7|本体のみ|
|||||XXX-XXX*7|本体のみ|
|交換時期(HCF Tray1 Feed/Retard/Nudger Roll)|5.18.1|Code=ChangeParts-|参照しない|PartsID&amp;Status||
|予備を用意(HCF Tray1 Feed/Retard/Nudger Roll)|5.18.2|||↑||
|交換時期(HCF Tray2 Feed/Retard/Nudger Roll)|5.19.1|||↑||
|予備を用意(HCF Tray2 Feed/Retard/Nudger Roll)|5.19.2|||↑||
|交換時期(HCF2 Tray1 Feed/Retard/Nudger Roll)|5.20.1|||↑||
|予備を用意(HCF2 Tray1 Feed/Retard/Nudger Roll)|5.20.1|||↑||
|交換時期(HCF2 Tray2 Feed/Retard/Nudger Roll)|5.21.1|||↑||
|予備を用意(HCF2 Tray2 Feed/Retard/Nudger Roll)|5.21.2|||↑||

※1:HCS1に関して:
HCS単体構成でHCSが故障したは、「故障(スタッカートレイ)」と表示する。
HCS重連構成でHCS1側が故障した場合は「故障(スタッカートレイ1)」と表示する。どちらもJRMからはHCS1という種別で通知されるので、UIでConfigを見てどちらの表示にするか判断する。
HCFも同様。
※2※3:NVMも参照 : ドラムの状態表示とシステムデータについて
システムデータの設定により、ドラム状態をReadyに置き換える事ができる(RF2588ドラムシャットオフ)。
JRMから取得するActiveFaultリストは、置き換えなしの状態になっているので、UI側で置き換え処理を行う。DeviceErrorはFaultCategoryをみて、InfoはParts種別とその状態をみて、そしてしかるべきシステムデータを参照して表示するしないを決定する。
表示しない条件について記載する。

|JRMから取得した情報|NVM|||
|---|---|---|---|---|
|カテゴリ|状態|||
|InfoでParts種別Drum|PreNearLifeEndの場合で|780266:ドラムPreNearステータス表示有無|が、『無し』になっている時表示しない|
||NearLifeEndの場合で|780267:ドラムNearステータス表示有無||
||QualityLifeEndの場合で|780268:ドラムQualityLifeEndステータス表示有無||
|Device ErrorのFault CategoryでDrumLifeEndを識別 *3|Life_End|780269:ドラムLifeEndステータス表示有無||

※4:K1,K2Tonerが両方なくなると、
- 両トナー切れDeviceErrorと
- トナー交換K1
- トナー交換K2
の3つがリストに表示される可能性がある。
両トナー切れを表示してる場合、K1K2の単品表示は不要であるが、これを実現するにはJRMから取得したリストを詰める操作が必要になる。現段階ではJRMから通知された通りに表示し、将来的にはK1,K2は表示しないような方向にする。
※5※6:IotRscも参照 : フューザー及びチャージコロトロン と システムデータについて(CH18601)
フューザーはERUであれば表示を行わない。チャージコロトロンも同。

|JRMから取得した情報|IOTリソース情報|||
|---|---|---|---|---|
|カテゴリ||||
|InfoでParts種別Fuser||ERU|の時表示しない|
|InfoでParts種別CcAssy||ERU||

実装情報
IOTリソース情報とは、具体的には
PfRscChangepartsCustomerChangeable、「PFV\_CHANGEPARTS\_FUSER」/「PFV\_CHANGEPARTS\_CC\_ASSY」で判断。
UIとして、『780-238:フューザーユニットのCRU/ERU切り替え』、『780-239:CC
AssyのCRU/ERU切り替え』は参照していない。
※7:具体的なエラー番号はAppendix参照のこと 
※8:原因画面では、カテゴリにより文言を決定しているが、詳細画面ではChainLink番号によって決定している。機会があれば両者は合わせた方が良い。

#### フォルト詳細(Current Fault)

1.  フォルト詳細一覧を表示する際、対象フォルトが発生していれば、リストに表示する

2.  一覧画面で表示する内容は、エラー箇所が特定できる内容とする。(正確にはダイアログ仕様書参照)

3.  

4.  フォルト詳細一覧画面表示中に、対象のフォルトが解除された場合、一覧画面をリハッシュする
実装情報
対象にする通知Eventは、IitStateEvent、IotStateEventとする。
IITJam数に変化があった場合リハッシュしてみる。結果、見た目は何も変わらず、前回と同じ項目が表示される事もある。同様にIotJam
/ IitInterlock / IotInterlock / DeviceError。

1.  表示順はコントローラ側の仕様に従う。

2.  詳細画面(Instruction画面)では、通常使用しているフォルト画面と同じものを表示する。

3.  フォルト詳細一覧画面で表示する項目とその表示条件については以下のとおり。具体的な値についてはAPPENDIX参照のこと。

|表示する項目|Apndx<br/>No<br/>|表示条件||||
|---|---|---|---|---|---|---|
|||Code|カテゴリ|サブパラメータ|備考|
|FF-Fault分類 : Jam||||||
|原稿詰まり|次項参照|フォルト原因と同じ。<br/>Code =IitJam <br/>あるいは<br/>Code =IotJam + サブパラメータとして通知されるZoneで<br/>表示する項目を決定する<br/>||||
|紙づまり(プリンター本体)|↑|||||
|紙づまり(フィニッシャー)|↑|||||
|紙づまり(インターフェースモジュール)|↑|||||
|紙づまり(スタッカートレイ)|↑|||||
|紙づまり(スタッカートレイ1)|↑||重連時|||
|紙づまり(スタッカートレイ2)|↑||重連時|||
|紙づまり(パンチモジュール)|↑|||||
|紙づまり(パンチモジュール)|↑||(UIでSpartaか判断)|||
|紙づまり(トリマーユニット)|↑|||||
|紙づまり(外部フィニッシャーインターフェースモジュール)|↑|||||
|紙づまり(くるみ製本機)|↑|||||
|FF-Fault分類 : Interlock||||||
|カバー確認(自動原稿送り装置)|↑|フォルト原因と同じ。<br/>Code =IitInterlock <br/>あるいは<br/>Code =IotInterlock + サブパラメータとして通知されるZoneで<br/>表示する項目を決定する<br/>||||
|カバー確認(プリンター本体)|↑|||||
|カバー確認(フィニッシャー)|↑|||||
|カバー確認(インターフェースモジュール)|↑|||||
|カバー確認(スタッカートレイ)|↑|||||
|カバー確認(スタッカートレイ1)|↑||重連時|||
|カバー確認(スタッカートレイ2)|↑||重連時|||
|カバー確認(パンチモジュール)|↑|||||
|カバー確認(パンチモジュール)|↑||(UIでSpartaか判断)|||
|カバー確認(トリマーユニット)|↑|||||
|トリマーダストボックス確認|↑|||||
|カバー確認(外部フィニッシャーインターフェースモジュール)|↑|||||
|カバー確認(くるみ製本機)|↑|||||
|FF-Fault分類 : DevcieError(消耗品)||||||
|ドラムカートリッジ交換|↑|ChainLink(FltType=device)|参照しない※1|XXX-XXX※2|※3:NVMも参照する|
|ドラムカートリッジ確認|↑|||XXX-XXX※2||
|トナー交換|↑|||XXX-XXX※2||
|トナー回収ボトル交換|↑|||XXX-XXX※2||
|トナー回収ボトル確認|↑|||XXX-XXX※2||
|パンチダストボックス確認|↑|||XXX-XXX※2||
||||||ホチキスカートリッジ確認にまとめる|
|ホチキスカートリッジ確認|↑|||XXX-XXX※2||
|クリーニングカートリッジ交換|↑|||XXX-XXX※2||
|クリーニングカートリッジ確認|↑|||XXX-XXX※2||
|消耗品確認|↑|||XXX-XXX※2||
|転写ベルト交換|↑|||XXX-XXX※2||
|転写ベルト確認|↑|||XXX-XXX※2||
|第2バイアス転写ロール確認|↑|||XXX-XXX※2||
|トナー確認|↑|||XXX-XXX※2||
|コイルパンチユニット確認|↑|||XXX-XXX※2|未使用|
|コイルパンチダストボックス確認|↑|||XXX-XXX※2|未使用|

※1:詳細画面のDevcieError(消耗品)のリストの文言決定条件は、ChainLink番号によって決定している。一方、原因画面では、カテゴリにより文言を決定している。機会があれば両者は合わせた方が良い。
※2:具体的なエラー番号はAppendix参照のこと 
※3:システムデータも参照する。CurrentMessageの章参照。
■詳細画面(Instruction画面)
1. 一覧画面から詳細表示することでInstruction画面を表示する。
2.
Instruction画面で表示する内容は、通常のフォルト画面で表示しているものと同じものを使う。
3. Keyの受付は特に制限なし。
4
Instruction画面表示中に対象のフォルトがなくなった場合、Instruction画面を閉じる。

#### フォルト履歴
1.フォルト履歴一覧画面では以下の表示を行う

|表示する項目|JRMリソース情報||
|---|---|---|---|
|1レコードにつき|エラーコード|DC122 (DiagFaultHistory)参照の事|
||日付||
||時刻||
||トータルボリューム||

1.
フォルト履歴画面で表示する内容は、DiagFaultHistoryと同じ内容とする。(項目が同じと言う意味で画面構成は異なります)
2. Keyの受付は特に制限なし。
3 フォルト履歴画面は対象の履歴が増減しても、リハッシュしない。
実装情報
UI-JRMには履歴の変化を通知する手段はありません。
4
パスウェー切り替えや他の画面がいなくなってフォアグラウンド化された時など、一覧を再表示するタイミングでリハッシュを行う。

### その他

**<参考資料>**

-   CH12407:

-   CH12508:

-   CH14525:

-   CH15513:

-   CH15777:

-   CH17210:

-   CH18718:

-   CH18601:

-   CH29440

-   CH29897:<PGS1254SGP-PL2>PGS2117SGP ActiveFault対応。  
          補足:ICPかSCPかの判断はUIで行う。日本語はICPもSCPも同じ。英語の場合SCPならSpartaと表現する。

#### Appendix (Q&A)

# 本項では、以下の理由から、質疑・背景等を記載します。

レビューの場では、「要求」と「それを実現できるか」という事が対になって話し合われます。

その時話し合われた実現概要や懸念点に対する回答は重要な情報です。

実現概要の話の中にResource
(JRMIF/Controllerから取得できる情報)が登場します。

UIが取得できるResourceに変化があると仕様にも影響します。

UI-DFDには、要求から抽出した「要求仕様」が書かれますが、既存実装から抽出された「実装仕様」も書かれています。

その仕様が、要求仕様としてはここまで求めたかったが、実装上の理由でこのような仕様となった…という経緯を残す事も大切な情報です。また、既存実装の枠組みなので、あえてUI-DFDに記載されていないケースがあります。

**実現方法について、正しくはDFD以降の設計書を参照してください。**

――――――――――――――――――――――――――――――――――――――

Q:どのエラーがアクティブフォルトの表示対象なのか?はどのように決まるのですか?

A:FFのFaultCodeListに記載されます。 以下はPGS2122SGPの例K1.1

――――――――――――――――――――――――――――――――――――――

Q:そのうち、どのエラーが詳細表示対象なのか? はどのように決まるのですか?

A: Jam/InterlockはZoneがあるものが対象になります。

   デバイスエラーは、UI側でインストラクション画面を持っているものを対象にします。

   2/23時点では、FFFaultListに乗っていませんが対象がわかる様に列を追加してくれそうです。

――――――――――――――――――――――――――――――――――――――

Q: 詳細画面を表示する時の話ですが、

JRMからは、"原因"相当のレスポンスが返されるが、その中から"詳細"で表示するものをピックアップするのは、UI側の役割・・・とありました。どのようにピックアップするのですか?

A: Jam/Interlockは、JRMレスポンスの「CodeType」をみればすぐに判断がつきます。

で残るは、DevcieError(消耗品) なのですが、これは、「Code=ChainLink & Type=DeviceError & ChainLink番号」 でピックアップします。APPENDIXを参照してください。

――――――――――――――――――――――――――――――――――――――

Q:IITインターロックはJRMからChain-Linkが取得できませんが、この場合もUI側でChainLink付加して表示しますか?

A:はい。通常のIITインターロックと同様にChainLink表示をお願いします。JRMから取得できないのであれば、通常のIITインターロックと同様に、UI側で部位とChainLinkの対応テーブルから、ChainLinkをわり出して表示してください。

――――――――――――――――――――――――――――――――――――――

Q:複数のインターロックが空いている状況で、一覧画面からインターロックInstruction画面を表示していると仮定します。

ここで、Instructionに表示されているデバイスのインターロックカバーを閉じると、一覧画面に戻ってほしいところですが、

カバーを閉じたことにより、通常のインターロック処理が走るため次のインターロックが表示されてしまいます。

一覧に戻るようにするには修正規模が大きいのでFCWの実装仕様としたいのですが問題になりますか?

A:一覧画面に戻って欲しいですが、FCW制限ということでよい。

――――――――――――――――――――――――――――――――――――――

Q: 「Y,M,C TonerEmpty」,「Stapler Fead Ready Fail」の Fault Code
がPGS2122SGP では Device Error で定義されいますが Pinot
では存在しません。

代わりに Operation のカテゴリに定義されています。Operationの
カテゴリに定義されているのは正しい仕様ですか?

A:2008.1.24富永さんより

正しいです。 Y,M,C
TonerEmptyでも、黒コピーは許可させるためにDevErrorにせずOpeErrorに
してます。

――――――――――――――――――――――――――――――――――――――

Q:Pinot では、Operation
のカテゴリに定義されるのが正しい仕様だとすると、CH12407-Active
Fault の Current Message に YMC Toner Empty のFault Code
が表示されません。

現在の仕様では、Operation
のカテゴリのフォルトは表示対象外になっているためです。これは問題ではありませんか?

(回答2):2008.1.25富永さんより

YMC Toner Empty(消耗品が無い)ことをお客様が知る手段は3個あります。

(1) YMC Toner Empty OpeError 画面

(2) 消耗品確認画面

(3) Active Fault画面 の Current Messageタブ

- DeviceErrorの場合→(1)(2)(3) 全てが有効

- OpeErrorの場合→(1)(2) が有効、(3)が出来ない

Pinotで現状通りOpeErrorであっても、(1)(2)により(トナーが無い)ことをお客様は検知できる。 → (3)が出来ないだけなら、市場で大きなクレームにはならないと思います。

SV評価で仮にBGを上げられても、「仕様通り」(OpeErrorは表示せず)で処理する方針とする。