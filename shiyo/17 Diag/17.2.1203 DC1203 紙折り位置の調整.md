## DC1203 紙折り位置の調整 

###### 機能概要

Feature&Function編 > 3-02-09 Diagnostics参照。

###### 機能と提供条件

C-Finisherまたはそれよりも上位のFinisherが接続され、且つ折り機能が有効な場合。(DC番号判定はしていない)

各Finisherにおける提供条件を以下に示す。(C、DはV2以降サポートしない。CH、D2Gに置き換わる)

|Finisher|機能提供条件|備考|
|---|---|---|---|
|C-Finisher|PDI:CFINISHER_KO_FOLD_AJUSTMENT_AVAILABLE_FLAGが有効、<br/>且つBookletオプションが有効<br/>||
|CH-Finisher|以下オプションが最低1つ有効な場合<br/>Booklet<br/>ZFold<br/>||
|D-Finisher|<br/>以下オプションが最低1つ有効な場合<br/>Booklet<br/>ZFold<br/>|実装だとプロダクト判断しているが、Finisher依存の機能なのだからプロダクト判断は不要のはず。<br/>↑FF記載が上記のようになっている。<br/>|
|D2G-Finisher|<br/>以下オプションが最低1つ有効な場合<br/>Booklet<br/>ZFold<br/>Creaser<br/>|↑|


本機能はタイプの設定(調整+調整値をプロファイルとして保存)と、トレイへのタイプ割り当ての2つの機能を提供する。

タイプは10個まで登録可能。(最大数10はUIがハードコーディングしている)

それぞれの機能提供条件を以下に示す。

|Finisher|機能提供条件|備考|
|---|---|---|---|
|トレイへのタイプ割り当て|MediaPopup(トレイ設定)画面種別が標準仕様の場合|標準仕様以外(プロ仕様)の場合、トレイだけでなく紙質に対してもタイプ割り当てが可能となるため、割り当てはMedia Popup画面、またはカスタム紙質設定画面で行う。<br/>トレイへのタイプ割り当て: Media Popup画面<br/>紙質へのタイプ割り当て: カスタム紙質設定画面(別DFD)<br/>|
|タイプの設定|常時||


###### 参考情報

LibGetOptSts("CFns") :C-Finisher装着有無

LibGetOptSts("CHFns") :CH-Finisher装着有無

LibGetOptSts("DFns") :D-Finisher装着有無

LibGetOptSts("D2GFns") :D2G-Finisher装着有無

LibGetOptSts("BMaker") :Bookletオプション

LibGetOptSts("ZFdr") :ZFoldオプション

LibGetOptSts("Creaser") :Creaser装着有無

LibGetCfgSts("TraySetupScreenSwitch") :MediaPopup(トレイ設定)画面種別

##### トレイへのタイプ割り当て
有効なトレイ一覧を表示し、各トレイに対して作成済みタイプの割り当てを行う。

|項目|設定範囲|表示条件|初期値/表示値|備考|
|---|---|---|---|---|---|
|トレイN|登録済みタイプ|有効なトレイの一覧を表示|対象のトレイに割り当てられたタイプM(1≦M≦最大数)に設定された名称を表示する。<br/>名称がブランクの場合は"タイプM"と表示。<br/>タイプが割り当てられていない場合は"初期値"と表示。<br/>||

###### 機種別制限・注意事項
- Fuhjin系のプロダクトのみ手差しトレイへのタイプ割り当ては不可(画面に表示しない)とする

##### タイプの設定
タイプ一覧を表示し、それぞれに対して削除、編集を行う。

|項目|設定範囲|表示条件|初期値/表示値|備考|
|---|---|---|---|---|---|
|タイプM|-|常時|対象タイプに設定された名称を表示。<br/>名称がブランクの場合は"(名称未設定)"、<br/>タイプが未登録の場合は"未登録"と表示。<br/>||


##### タイプMの設定
###### 表示項目
以下調整値をタイプMとして保存可能とする。
個々の調整値に対して個別にリセット(デフォルトに戻す)可能とする。
Finisher毎に保存可能な調整値を以下に示す。

|調整項目|初期値|C-Fin|CH-Fin|D-Fin|D2G-Fin|備考|
|---|---|---|---|---|---|---|---|
|名前|(名称未設定)|○|○|○|○|全角30/半角60文字まで<br/>JISX0208_JISX0201(CH14315)<br/>|
|二つ折り|初期値|○|○|○|○|Bookletオプション有効時|
|製本|初期値|○|○|○|○|Bookletオプション有効時|
|内三つ折り A4 SEF|初期値|-|○|○|○|ZFoldオプション有効時|
|内三つ折り 8.5x11 SEF|初期値|-|○|○|○|ZFoldオプション有効時|
|外三つ折り A4 SEF|初期値|-|○|○|○|ZFoldオプション有効時|
|外三つ折り 8.5x11 SEF|初期値|-|○|○|○|ZFoldオプション有効時|
|Z折り A3 SEF|初期値|-|○|○|○|ZFoldオプション有効時|
|Z折り B4 SEF|初期値|-|○|○|○|ZFoldオプション有効時|
|Z折り 11x17 SEF|初期値|-|○|○|○|ZFoldオプション有効時|
|Z折り 八開 SEF(中国本土)|初期値|-|○|○|○|ZFoldオプション有効、且つ<br/>八開サイズグループが中国本土<br/>|
|Z折り 八開 SEF(台湾)|初期値|-|○|○|○|ZFoldオプション有効、且つ<br/>八開サイズグループが台湾<br/>|
|強く折るときの二つ折り|初期値|-|-|-|○|Creaser装着、且つBookletオプション有効時|
|強く折るときの製本|初期値|-|-|-|○|Creaser装着、且つBookletオプション有効時|
|折り目 二つ折り|初期値|-|-|-|○|Creaser装着時|
|折り目 内三つ折り|初期値|-|-|-|○|Creaser装着時|
|折り目 外三つ折り|初期値|-|-|-|○|Creaser装着時|
|折り目 Z折り|初期値|-|-|-|○|Creaser装着時|
|折り目 観音折り|初期値|-|-|-|○|Creaser装着時|
|折り目 巻き四つ折り|初期値|-|-|-|○|Creaser装着時|
|折り目 蛇腹3本折り|初期値|-|-|-|○|Creaser装着時|
|折り目 蛇腹4本折り|初期値|-|-|-|○|Creaser装着時|
|折り目 蛇腹5本折り|初期値|-|-|-|○|Creaser装着時|
|折り目の圧力|初期値|-|-|-|○|Creaser装着時|

###### 参考情報
LibGetCfgSts("GCO") :八開サイズグループがGCO(中国本土)かどうか

##### 二つ折り、強く折るときの二つ折り、強く折るときの製本

###### 表示項目

|項目|設定範囲|表示条件|初期値/表示値|備考|
|---|---|---|---|---|---|
|調整方向|左が長い<br/>右が長い<br/>|常時|Disable、未選択<br/>初回確認プリント後に有効となる<br/>||
|1束の枚数|・二つ折り時<br/>1～5<br/>・製本時<br/>1～30<br/>|常時|1||
|出力用紙のA値|Appendix参照|常時|0||
|確認プリントボタン|-|常時|||

Appendix:「17.2.1203 DC1203
紙折り位置の調整\_Appendix.xlsx」の\[各折り機能の調整範囲・初期値\]シート

##### 製本

###### 表示項目:メイン画面

|項目|設定範囲|表示条件|初期値/表示値|備考|
|---|---|---|---|---|---|
|用紙種類ボタン|-|Appendix参照|Appendix参照||
|調整方法|標準<br/>枚数指定<br/>|対象紙質の最大束数が2～4の場合は非表示。|標準||
|枚数指定Spin|Appendix参照|対象紙質の最大束数が5以上の場合は非表示。|3||
|確認プリントボタン|||||

最大束数が2の場合、2枚束のみの調整を行う。
最大束数が3～4の場合、標準調整で3枚束、4枚束の調整を行う。
Appendix:「17.2.1203 DC1203
紙折り位置の調整\_Appendix.xlsx」の\[製本>用紙種類\]シート

###### 表示項目:調整画面

|項目|設定範囲|表示条件|初期値/表示値|備考|
|---|---|---|---|---|---|
|調整方向|左が長い ホチキス左<br/>右が長い ホチキス左<br/>左が長い ホチキス右<br/>右が長い ホチキス右<br/>|常時|Disable、未選択<br/>初回確認プリント後に有効となる<br/>||
|調整方法|標準<br/>枚数指定<br/>||||
|出力用紙のA/B値|Appendix参照|常時|0||
|確認プリントボタン|||||

Appendix:「17.2.1203 DC1203
紙折り位置の調整\_Appendix.xlsx」の\[各折り機能の調整範囲・初期値\]シート

##### その他の折り

###### 表示項目

|項目|設定範囲|表示条件|初期値/表示値|備考|
|---|---|---|---|---|---|
|出力用紙のN値|Appendix参照|常時|Disable<br/>初回確認プリント後に有効となる<br/>||
|仕上げたいN値|Appendix参照|D2G-Fin接続時以外|Disable<br/>初回確認プリント後に有効となる<br/>|DMP14以降、<br/>CH-Finisher接続時は非表示<br/>|
|確認プリントボタン|-|常時|||

Appendix:「17.2.1203 DC1203
紙折り位置の調整\_Appendix.xlsx」の\[各折り機能の調整範囲・初期値\]シート

##### Appendix1:調整値の入力方法について
各折り機能の調整画面では、装着されているFinisherに応じて調整値の入力方法が異なる。
以下に入力方法について示す。

|**Finisher種別**|**入力方法**|**備考**|
|---|---|---|---|
|C-Finisher|絶対値入力||
|CH-Finisher|絶対値入力|DMP14以降はD2G-Finisherと同じ、相対値入力とする。<br/>DMP14以降の初期値についてもD2G-Finisherと同じ<br/>|
|D-Finisher|絶対値入力||
|D2G-Finisher|相対値入力|Readで取得した調整値に関わらず、画面上の初期値は常に0を表示する。<br/>但しZ折りの場合、出力用紙のA値の初期値は用紙長の半分とする。<br/>詳細の値は「17.2.1203 DC1203 紙折り位置の調整_Appendix.xlsx」の[各折り機能の調整範囲・初期値]シートを参照のこと。<br/>ユーザーが入力した調整値とReadで取得した値を内部的に足してControllerに通知する。<br/>但し用紙長パラメータは絶対値入力のままとする。(FF参照)<br/>|

任意のパラメータについて、絶対値入力と相対値入力の例を以下に示す。

|**ユーザー操作**|**絶対値入力**|**相対値入力**|**備考**|
|---|---|---|---|---|
|Cont調整範囲-10.0～+10.0のパラメータについて、Controllerから取得した値が+3.0の場合|初期表示は以下の通り<br/>調整範囲:-10.0～+10.0<br/>現在の値:+3.0<br/>|初期表示は以下の通り<br/>調整範囲:-13.0～+7.0<br/>現在の値:+0.0<br/>||
|↑に引き続き、ユーザーが現在の値を+5.0に変更して調整値反映操作を行った場合|Controllerに以下を通知調調整値:+5.0|Controllerに以下を通知<br/>調整値:+8.0<br/>(内部値+ユーザー値)<br/>||
|↑に引き続き、再度調整値入力画面を開いた場合|初期表示は以下の通り<br/>調整範囲:-10.0～+10.0<br/>現在の値:+5.0<br/>|初期表示は以下の通り<br/>調整範囲:-18.0～+2.0<br/>現在の値:+0.0<br/>||

調整方向の指示を伴うパラメータの相対値入力については方向の考慮が必要、以下に例を示す。

|**ユーザー操作**|**絶対値入力**|**相対値入力**|**備考**|
|---|---|---|---|---|
|調整向き指定を伴い、Cont調整範囲が左右それぞれ0～10.0、パラメータについて、Controllerから取得した値が5.0、調整向きが右の場合|初期表示は以下の通り<br/>調整範囲:0～10.0<br/>現在の値:5.0<br/>調整向き:右<br/>|初期表示は以下の通り<br/>調整範囲:0～5.0<br/>現在の値:0.0<br/>調整向き:右<br/>||
|↑に引き続き、ユーザーが調整向きを左に変更した場合|調整範囲:0～10.0<br/>現在の値:5.0<br/>調整向き:左<br/>|調整範囲:0.0～15.0<br/>現在の値:0.0<br/>調整向き:左<br/>||
|↑に引き続き、ユーザーが現在の値を1.0に変更して調整値反映操作を行った場合|Controllerに以下を通知<br/>調整値:1.0<br/>調整向き:左<br/>|Controllerに以下を通知<br/>調整値:4.0<br/>調整向き:右<br/>|相対値入力ではユーザーが左を指定しても、内部的にまだ右に長い場合はControllerに右として通知する。|


##### Appendix2:各折り機能調整画面の確認プリントボタンについて
各折り機能調整では確認プリント→調整値の入力→確認プリント・・・を繰り返すことで調整を行うが、
「確認プリント」ボタン押下時の動作は以下の通りJRMに指定する必要がある。

|**ユーザー操作**|**JRMへの通知**|**備考**|
|---|---|---|---|
|初期値(調整値未設定)の折り機能を開いて「確認プリント」押下|DeviceControlRequest(SetDFinFoldAdjustInitPrintFold)<br/>ReportRequest(各折り機能確認レポート)<br/>||
|↑に引き続き、調整値を入力後「確認プリント」押下|DeviceControlRequest(WriteDFinFoldAdjustTempValue)<br/>ReportRequest(各折り機能確認レポート)<br/>|2回目以降は常にこちら|


##### Appendix3:確認プリントの用紙選択について
各折り機能調整では確認プリントの際にトレイ選択が可能となっているが、一部のプロダクトでは手差しをサポートしない。
手差しのサポート有無はFeature:DIAG\_DC1203\_MSIにより判断する。
手差しトレイ選択時には調整中の折り機能に応じて用紙サイズ、用紙種類が選択可能である。
選択可能な用紙サイズ・用紙種類は「17.2.1203 DC1203
紙折り位置の調整\_Appendix.xlsx」の\[確認プリント>手差し選択時のサイズ・紙質\]
シートを参照のこと。