## Version Information 

### HB UI を搭載する機種(Kutani/PGS7018SGP/Raijin)

HB UI ソフトウェアは Controller ROMに含まれるため、Panel のVersion
情報は内部情報として扱い外部には公開しない。

内部情報としては、Imari と同様の付与規定とする。

###### 開発途中のバージョン付与規定

開発中バージョン付与方法については、以下のようにする。

1.  Majorバージョンは、UT/IFT/SSTでは210番台を使用する。  
    215 : Kutani/PGS7018SGP  
    216 : Kutani PL/Naushicaa  
    217 : Raijin

2.  Minorバージョンは、特に指示がない限り0を使用する。

3.  Revisionは、Control ROMは奇数(1,3,5,…,255)を使用する。Frame ROM
    は偶数を使用する(0,2,4,6,…,254)。

4.  Languageは、常に0を使用する。

###### 市場導入後のバージョン付与規定

T.B.D.

### HB─ UIを搭載する機種(Imari/Imari-AP/Carrera/Allagash)

ImariではCH1527により、Lang情報は内部的に保持する情報として扱い、表示はしない仕様となった。よって、LCD上への表示は、「**Major.Minor.Revision**」とする。

###### 目的

ImariでのROM Version 管理規定を記述する。

###### 適用範囲

Imariファミリー商品、及び他社へのOEM商品

###### 対象

Imariプロダクトのサブシステム全てのROMが対象となる。MF-UIでは、UI Conrol
ROM及びFrame Data
ROMが対象であり、以降の記述はその2つのROMを対象とする規定とする。

###### 構造

フォーマットは、Major、Minor、Revision、Language情報をピリオドでつないだ形式で表現される。

「**Major.Minor.Revision.Language**」

"Major" : Major Version (0-255)

1byteデータ。開発バージョンと市場導入バージョンを区別するために使用する。開発バージョンは、テストフェーズによっても区別される。

"Minor" : Minor Version(0-255)

1byteデータ。機能の導入内容を示す。

"Revision" : Revision Version(0-255)

1byteデータ。バグフィックス状況を区別するために使用する。バグフィックスによる再リリースではこのバージョンを必ず上げる必要がある。

"Language" : Language Infomation(0-65535)

2byteデータ。利用可能な言語情報を示す。

###### メモリ上の配置方法

1.  Control
    ROMの場合、VERSION\_CONSTセクションの先頭アドレスから5byteの領域に格納されるものとする。

2.  Frame ROMの場合、Frame
    ROMの先頭アドレスから5byteの領域に格納されるものとする。

例えば、バージョンが、「66.12.16.20853」である場合、メモリ上は以下のようなバイト列として格納されている必要がある。

「450C105175」

サブシステム間でのバージョン情報のI/Fは5byteのバイト列を送受することで実施するものとする。表示形式のASCII文字列を使用しない。

###### 開発途中のバージョン付与規定

開発中バージョン付与方法については、以下のようにする。

1.  Majorバージョンは、UT/IFT/SSTでは210番台を使用する。  
    210 : ImariAtLaunch/ImariPL1/ImariPL2  
    213 : ImariPL3  
    214 : Allagash

2.  Minorバージョンは、特に指示がない限り0を使用する。

3.  Revisionは、Control ROMは奇数(1,3,5,…,255)を使用する。Frame ROM
    は偶数を使用する(0,2,4,6,…,254)。

4.  Languageは、常に0を使用する。

###### 市場導入後のバージョン付与規定

-   Majorバージョンは、市場導入時のバージョンを現す(0～255)。
    > 新規機能を導入したロンチ毎に1つずつ増加する。  
    > 1 : Imari AtLaunch/PL1  
    > 2 : Imari PL2/ImariAP/Carrera  
    > 3 : Imari PL3/PL3-Based-ImariAP/PL3-Based-Carrera  
    > 4 : Allagash

-   Minorバージョンは、Control ROMとFrameROMとで使用方法が異なる。  
    Control ROM では、常に 0 を使用する。  
    Frame ROMでは、テリトリ/言語情報/個別対応を現す。  
    百の位(0～2) : テリトリを現す。  
    0 : FX、1 : PGS1002SGP/PGS2003SGP、2 : AP
十の位(0～9) : 言語の組合わせを現す。
0 : 日本語、1 : 英語、 2 : 日本語/英語 (FXの場合)  
0 : 英語、 1 : 英語/韓国語、 2 : 英語/台湾語(APの場合)  
0 : 英語(PGS1002SGP/PGS2003SGPの場合)
一の位(0～9) : 個別対応(機能がFX仕様と同じでUI画面のみの変更)を現す。
0:FX、1:Circle-K、2:松下OEM

-   Revision は、Control ROMは奇数(1,3,5,…,255)を使用する。Frame ROM
    > は偶数を使用する(0,2,4,6,…,254)。

### FCW UI を搭載する機種(Fuhjin/Tarzan)

FCWUI ソフトウェアは Controller ROMに含まれるため、Panel のVersion
情報は内部情報として扱い外部には公開しない。

###### 構造

フォーマットは、Major、Minor、Revision、Language情報をピリオドでつないだ形式で表現される。

「**Major.Minor.Revision.Language**」

"Major" : Major Version (0-255)

1byteデータ。

"Minor" : Minor Version(0-255)

1byteデータ。機能の導入内容を示す。

"Revision" : Revision Version(0-255)

1byteデータ。バグフィックス状況を区別するために使用する。バグフィックスによる再リリースではこのバージョンを必ず上げる必要がある。

"Language" : Language Infomation(0-65535)

2byteデータ。利用可能な言語情報を示す。

###### 開発途中のバージョン付与規定

開発中バージョン付与方法については、以下のようにする。

1.  Majorバージョンは、UT/IFT/SSTでは230番台(T.B.D.)を使用する。  
    xx1 : Fuhjin  
    xx2 : Fuhjin PL  
    xx3 : Tarzan

2.  Minorバージョンは、特に指示がない限り0を使用する。

3.  Revisionは、0からシーケンシャルに255まで使用する。

4.  Languageは、常に0を使用する。

###### 市場導入後のバージョン付与規定

T.B.D.

***==== 以下、参考資料 =====***

*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*

IMARIのVersionについては まだ 決まっていないそうなので 前半にTOWADA
LouiseSOD、後半には Limoges / SFIDA
のProgramに埋め込むVersionの付与規定をかきだしてあります。 ROM
Versionについて 決まり次第 全体を書き直す予定。

なお、前半のSOD記述にかんして、TOWADA
SODのみに記載されている事項は(TOWADA)、Louiseのみの場合は(Louise)と記している。

*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*～*

###### 目的

製品開発にあたり、S/WのROM作成におけるバージョン管理ツールを規定する。本規定は次の制約を受ける。(TOWADA)

1.  各機種共通とする

2.  過去のしがらみを引き継ぐ

3.  TS要求に準拠する

4.  TRESSで一意に識別可能

5.  Romラベルに印刷可能

6.  H/Wに影響を与えない(シルク印刷)

###### 適用範囲

富士PGS1012SGPで設計・開発する全商品。

TFX開発製品

他社へのOEM商品(Louise)

OEM供給を受ける商品群は適用外

###### ROM Version

ROM Versionを表現するものとして次の3種類が存在する。(TOWADA)

1.  機能設定リスト等に表示されるROM Version

2.  ROMのラベルに表示されるVersion **(← Down Load導入により不要だが
    Programに埋め込む)**

3.  ROM DataとしてProgramに埋め込むVersion

ROM Versionを表現するものとして次の2種類が存在する。(Louise)

1.  内部的なバージョン
ROM内部に定義しているVersionで、機能設定リストやプロトコルモニタ等で表示される。

1.  外部的なバージョン
ROMのラベルに表示されるVersion。

###### Version規定

1.  機能設定リスト等に表示されるROM Version (Louiseでいう
    「内部的バージョン」)
1-1)フォーマット 「**AB**-**CD**-**EF**」

**"AB"** : テリトリー
FX版 : FX
OEM版 : EM
PGS1003SGP版 : PGS1003SGP
PGS2001SGP版 : PGS2001SGP **(←PGS2003SGPになったから
今後はPGS2003SGP)**
FXAP版 : AP(新opco)
AQ(旧opco)
**(↑ MFではコントロールROMもMarketによって異なるので
Limogesと違いコントロールにもテリトリが必要との
佐藤さんのコメントあり)**
**"CD-EF"** : Version Number
CD : 機能追加時または◎が'9'を越える時に更新される。 **(← ◎
ってなに?)**
E : 機能追加を伴わない変更時に更新される。(XCN \[0～9\])
F : 個別対応(営業要求 トラブル個別対応)時に更新される。
ベースで出荷するM/CのVersionは「**01-00**」が望ましい
開発段階(PM機まで)のVersionは全て「**0-xx**」とする。下二桁を使用してROMを作成するたびに1ずつ上げる。出荷までに0-01から0-99まで作成することができる。
CDは大掛かりな修正が行われたが、新規機能を導入したか、EFが99を越える場合に更新する。EFは、一般的な修正を行った場合に更新する。個別対応などのユニークな修正についてはFを更新する。
Sim – B1導入時は 「01-00」とする。 (Louise)
Louiseでは(00-00～99-99 のデシマル表記) と明記されている。 **(←
書いた方が良いとの 佐藤さんのコメントあり。)**
1-2)例
FX版 : FX-01-80
OEM版 : EM-01-80
PGS1002SGP版 : PGS1002SGP-02-00

1.  ROMラベルに表示される Version(Louiseでいう 「外部的バージョン」)
2-1)フォーマット
1行目 「**GGGA**」
2行目「**BCD.EF**」
(この部分が通信でやりとりされる。この為ラベル2行目でROMを一意に識別できなければならない)
(ラベル3行目には機種グループコードを入れる事が望ましい。(例:Able3200→"3200"))
(TOWADA)

**"GGG"** : モジュール識別

M1E / M10 / G3M / G4M / ICM / PNL / IPS / BM (TOWADA)

MF- (MF Mail) / G3M (G3M) / G4M (G4M) / IG4 (ICM/G4M) (Louise)

**"A"** : テリトリー
FX版 : F
OEM版 : E
PGS1003SGP版 : X (TOWADA Louiseでは PGS2002SGP版 )
PGS2001SGP版 : R **(←PGS2003SGPになったから X???)**
FXAP版 : A

**"B"** :
テリトリー内でROMの種類が複数存在する場合の種類を表す為に用意されるものでROMの種類が一種類の場合にも付与する。
(TOWADA)
FX版 : V (TOWADA では 1Mbytes対応用)
: W (TOWADA では 2Mbytes対応用)
OEM版 : M
PGS1002SGP版 : C
PGS2001SGP版 : X **(←PGS2003SGPになったから L???)**
FXAP版 : P(新opco) / Q(旧opco)
(Louise)
Base : V
松下モデム版 : M
OEM : C
FXAP版 : P
Base英文キット : B
NTT OEM : T
など
**"CD-EF"** : Version Number

1.  と同様。ただし "C"は実際には表示されない。
Louiseでは(00-00～99-99 のデシマル表記) と明記されている。 **(←
書いた方が良いとの 佐藤さんのコメントあり。)**
2-2)例
FX版 : M1EF V1.80
OEM版 : M1EE V1.80
PGS1002SGP版 : G3MX V1.20

1.  ROM DataとしてProgramに埋め込むVersion **(←
    もし、機能リストのVersion付与規定と異なるのならば、記載)**
TBD

###### Version Numberについて

Version
NumberはM/Cの最初の出荷時を01-00とする。その後、OEM/PGS1002SGP/PGS2003SGP
バージョン等が開発された時は、その時点で01-00とはしない。Version
Numberは出荷時期を表す。
例)
「FX版 : M1EF V2.30」の時点でPGS1002SGP版 M1ExのROMを作成した場合、
PGS1002SGP版 : M1EX C2.30 (または
C2.40…V2.3からトラブル対応等が多く導入された場合) となる。

###### テリトリーに依存しない共通ROMの取り扱い

テリトリーには存在せずM/N共通で使用する場合などは、上記のルールに該当しなくなる。これら共通に使用されるROMの取り扱いについて規定する。ここで"AB"は<ROM
Version規定>に関するものである。

1.  全テリトリ共通 / FX共通

**"A"** : F (ベースM/Cを最初に作成する為)

**"B"** : VまたはW 、 X (<ROM Version規定> 参照)

1.  M/N共通

**"A"** : H

**"B"** : Q

もし、M/NdeFXと共通のROMが存在する場合は、FXの仕様に準拠する。

###### FONT ROM

FONT ROMのVersionは上記規定には包含されない。下記の通り規定される。

1)フォーマット 「**AB**-**CD**-**EF**」

**"AB"** : ( TOWADA SODでは
各Versionに対する、「対象国」「第一言語」「第二言語」「Selector
Value」が一覧になった表 下に例あり が貼付されていました。)

**"CD-EF"** : Version Number
2)ROMラベルに表示されるVersion
フォーマットと同様
ABフォーマット一覧表の例

|Version|対象国|第一言語|第二言語|Selector Value|
|---|---|---|---|---|---|
|FA|Japan|Japanese|-|0x00|
|FB|Taiwan|English|中国語|0x01|
|FC|Korea|English|-|-|


|Version|対象国|第一言語|第二言語|Selector Value|
|---|---|---|---|---|---|
|XA|U.S.A|English|Spanish|0x01|
|XB|Canada|English|French-Canadian|0x02|
|PGS1002SGP|Latin America|Spanish|English|0x04|


***<<参考>>***

LimogesでのVersion 付与方法

1)UI Program Version

フォーマット 「**AA**-**BB**-**C**-**D**」

"AA" : Major Version (00-99)

開発中は必ず0、Launch時に上げる

"BB" : Minor Version(00-99)

Majorに対する現状のVersion

"C" : Revision Version(00-09)

Minorに対する現状のVersion

"D" : Patch Version(0-9 \[ASCII CODE 30h-39h\])

通常0 (ASCII 30h)

例) Limoges全体の正式VersionがV6.1の場合

1.  01 00 30

例) 開発中 UI VersionがLFX3.1の場合
00 03 01 30

Limogesの失敗情報))
Launchにて定義されたVersion(例えばV6.0)に対し、いずれかのSUBに変更が入った場合、全体VersionはV6.1となる。この時、変更のあったSUBはリリースソフトのVersionをV6.1とし、変更のないSUBはV6.0のままとなる。したがって、ROM
Versionをみれば いつの段階で変更が入ったのかがわかる。
しかし、何故かUIは そのルールから反している。たとえば、今の例で
V6.1になったとき、UIに変更がなかったとすると、全体VersionがV6.1になった段階ではUIのVersionはV6.0である。(これは普通)
その後、UIに修正があった場合、全体VersionはV6.2となるので、UIもV6.2としてReleaseするべきところ、V6.1としている。(UI内部では
飛び番がない) 。
理由は、VersionをPSWで見るためのI/F作成段階で、Frame
ROM用のI/Fを忘れてしまい…、気づいた時には追加できなくなっていたので(SYSが対応できない)、FrameのVersion
UpでもUI
ControllのVersionを変更しなくてはならなくなった。更に、Frameの Version
Upは回数が多いためrevisionだけでは対応しきれないと予測した為に他SUBとは違う、独自のVersion管理方法をとる事となった。
また、Version名のつけかたが フォーマットにのっとれば **Vaa.bb-Rcd**
(abcdは上記フォーマットのABCDと同意)とするべきだが、LFXb.c
となっているので、混乱する。たとえば、**LFXb.c**形式だと
LFX4.10というVersionもつけたくなるが、フォーマット欄で示した通り、Cに10
つまり "a"をセットしても
Cは0～9までなので範囲チェックでNGとなり、PSWがVersionを正しく読み取れない。

2)UI Program ファイル名(バイナリーファイル)

フォーマット 「**u0**-**AA**-**BB**-**C'**-**D'**」 (小文字の"u"は UI
を意味し、"0"はProgram Fileを意味する。 従って**u0** 固定)

"AA" "BB" : 1)と同様

"C'" : Revision Version(0-9)

Minorに対する現状のVersion

"D'" : Patch Version(0-9 )

通常0 (ASCII 30h)

例) Limoges全体の正式VersionがV6.1の場合

u0 06 01 0 0.bin

3)Frame Data Version

フォーマット 「**AA**-**BB**-**C**-**E**」

"AA" "BB" "C" : 1)と同様

"E" : Language Code (ASCII)

日本語(a : 61h) AP英語(c : 63h) ハングル語(e : 65h) US英語(h :
68h) UK英語(l : 6ch)

例)LJ2.8-R2.1(日本語)の場合

00 28 02 61

4)Frame Dataファイル名(バイナリーファイル)

フォーマット 「**u1**-**AA**-**BB**-**C'**-**D"**」 (小文字の"u"は UI
を意味し、"1"はFrame Fileを意味する。 従って**u1** 固定)

"AA" "BB" : 1)と同様

"C'" : 2)と同様

"D" " : Language

例) LJ2.8-R2.1(日本語)の場合

u1 00 28 2 a.bin

他Productの仕様

Sfida → Limogesと同じ

###### 制限・注意事項/備考

-   ここで記述した UI ROM
    VersionはGreeting画面上に表示するDataとしても利用する。

-   機械状態画面に表示する ROM Versionについては
    どの情報を表示するのか未定である。(9月16日現在)

###### 参考資料
TOWADA Software Functional Description(ROM バージョン作成規定)
Louise MF System Operating Description K1.0 (ROM バージョン作成規定)
Limoges UI Program Versionの命名方法
SFIDA Download 検討会 3月19日議事録